Lmod has detected the following error: The following module(s) are unknown:
"anaconda3/2021.05-gcc-9.4.0"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "anaconda3/2021.05-gcc-9.4.0"

Also make sure that all modulefiles written in TCL start with the string
#%Module



Lmod has detected the following error: The following module(s) are unknown:
"cuda/11.1.1-gcc-9.4.0"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "cuda/11.1.1-gcc-9.4.0"

Also make sure that all modulefiles written in TCL start with the string
#%Module



Lmod has detected the following error: The following module(s) are unknown:
"cudnn/8.0.5.39-11.1-gcc-9.4.0"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "cudnn/8.0.5.39-11.1-gcc-9.4.0"

Also make sure that all modulefiles written in TCL start with the string
#%Module



Tue Sep 24 11:35:26 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.183.01             Driver Version: 535.183.01   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A30                     On  | 00000000:19:00.0 Off |                    0 |
| N/A   31C    P0              30W / 165W |      0MiB / 24576MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
/var/lib/slurm/slurmd/job21249604/slurm_script: line 18: activate: No such file or directory
2024-09-24 11:35:29.762746: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-09-24 11:35:29.805519: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-09-24 11:35:30.419449: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
INFO:__main__:
 Fold 0 started ...................................... 

2024-09-24 11:35:31 [INFO]: Using the given device: cuda
2024-09-24 11:35:31 [INFO]: Model files will be saved to /scratch/users/k23031260/PyPOTS/20240924_T113531
2024-09-24 11:35:31 [INFO]: Tensorboard file will be saved to /scratch/users/k23031260/PyPOTS/20240924_T113531/tensorboard
INFO:__main__:
 Training..................................... 

2024-09-24 11:35:40 [INFO]: Bayesian_DEARI initialized with the given hyperparameters, the number of trainable parameters: 19,683,162
Model state change to unfreeze!
2024-09-24 11:37:21 [INFO]: Epoch 001 - training loss: 59.3099, validation loss: 53.5941, 
2024-09-24 11:37:21 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch1_loss53.59405458890475.pypots
Model state change to unfreeze!
2024-09-24 11:38:44 [INFO]: Epoch 002 - training loss: 50.0002, validation loss: 47.5799, 
2024-09-24 11:38:44 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch2_loss47.57988827045147.pypots
2024-09-24 11:39:47 [INFO]: Epoch 003 - training loss: 45.3523, validation loss: 44.1674, 
2024-09-24 11:39:48 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch3_loss44.16741708608774.pypots
Model state change to unfreeze!
2024-09-24 11:41:11 [INFO]: Epoch 004 - training loss: 42.6018, validation loss: 42.0820, 
2024-09-24 11:41:11 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch4_loss42.082020392784706.pypots
2024-09-24 11:42:14 [INFO]: Epoch 005 - training loss: 40.7200, validation loss: 40.5412, 
2024-09-24 11:42:14 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch5_loss40.54117232102614.pypots
Model state change to unfreeze!
2024-09-24 11:43:37 [INFO]: Epoch 006 - training loss: 39.3913, validation loss: 39.3906, 
2024-09-24 11:43:37 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch6_loss39.390625.pypots
2024-09-24 11:44:41 [INFO]: Epoch 007 - training loss: 38.3295, validation loss: 38.4618, 
2024-09-24 11:44:41 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch7_loss38.46175942054162.pypots
Model state change to unfreeze!
2024-09-24 11:46:04 [INFO]: Epoch 008 - training loss: 37.4560, validation loss: 37.6877, 
2024-09-24 11:46:04 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch8_loss37.687663738544174.pypots
2024-09-24 11:47:07 [INFO]: Epoch 009 - training loss: 36.6874, validation loss: 37.0024, 
2024-09-24 11:47:08 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch9_loss37.00240355271559.pypots
Model state change to unfreeze!
2024-09-24 11:48:30 [INFO]: Epoch 010 - training loss: 36.0843, validation loss: 36.4233, 
2024-09-24 11:48:31 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch10_loss36.42325239915114.pypots
2024-09-24 11:49:34 [INFO]: Epoch 011 - training loss: 35.5541, validation loss: 35.9443, 
2024-09-24 11:49:34 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch11_loss35.944291628324066.pypots
Model state change to unfreeze!
2024-09-24 11:50:57 [INFO]: Epoch 012 - training loss: 35.0886, validation loss: 35.4757, 
2024-09-24 11:50:57 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch12_loss35.47568599994366.pypots
2024-09-24 11:52:00 [INFO]: Epoch 013 - training loss: 34.6153, validation loss: 35.1134, 
2024-09-24 11:52:00 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch13_loss35.11338806152344.pypots
Model state change to unfreeze!
2024-09-24 11:53:38 [INFO]: Epoch 014 - training loss: 34.3453, validation loss: 34.7586, 
2024-09-24 11:53:38 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch14_loss34.758580721341644.pypots
2024-09-24 11:54:42 [INFO]: Epoch 015 - training loss: 33.9078, validation loss: 34.4245, 
2024-09-24 11:54:42 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch15_loss34.42445461566631.pypots
Model state change to unfreeze!
2024-09-24 11:56:20 [INFO]: Epoch 016 - training loss: 33.5242, validation loss: 34.1557, 
2024-09-24 11:56:20 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch16_loss34.155723278339096.pypots
2024-09-24 11:57:24 [INFO]: Epoch 017 - training loss: 33.2188, validation loss: 33.9189, 
2024-09-24 11:57:24 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch17_loss33.91888222327599.pypots
Model state change to unfreeze!
2024-09-24 11:59:02 [INFO]: Epoch 018 - training loss: 32.9761, validation loss: 33.7250, 
2024-09-24 11:59:02 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch18_loss33.72504513080303.pypots
2024-09-24 12:00:05 [INFO]: Epoch 019 - training loss: 32.7178, validation loss: 33.5046, 
2024-09-24 12:00:06 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch19_loss33.50457367530236.pypots
Model state change to unfreeze!
2024-09-24 12:01:44 [INFO]: Epoch 020 - training loss: 32.5741, validation loss: 33.6889, 
2024-09-24 12:02:47 [INFO]: Epoch 021 - training loss: 32.5848, validation loss: 33.2633, 
2024-09-24 12:02:47 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch21_loss33.263276026799126.pypots
Model state change to unfreeze!
2024-09-24 12:04:25 [INFO]: Epoch 022 - training loss: 32.1866, validation loss: 33.1109, 
2024-09-24 12:04:26 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch22_loss33.11091217627892.pypots
2024-09-24 12:05:29 [INFO]: Epoch 023 - training loss: 32.0543, validation loss: 32.9553, 
2024-09-24 12:05:29 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch23_loss32.9553400186392.pypots
Model state change to unfreeze!
2024-09-24 12:07:07 [INFO]: Epoch 024 - training loss: 31.8725, validation loss: 32.8766, 
2024-09-24 12:07:07 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch24_loss32.876553315382736.pypots
2024-09-24 12:08:11 [INFO]: Epoch 025 - training loss: 31.7538, validation loss: 32.7672, 
2024-09-24 12:08:11 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch25_loss32.76721514188326.pypots
Model state change to unfreeze!
2024-09-24 12:09:49 [INFO]: Epoch 026 - training loss: 31.4699, validation loss: 32.5798, 
2024-09-24 12:09:49 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch26_loss32.5797606248122.pypots
2024-09-24 12:10:53 [INFO]: Epoch 027 - training loss: 31.3968, validation loss: 32.4902, 
2024-09-24 12:10:53 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch27_loss32.49016864483173.pypots
Model state change to unfreeze!
2024-09-24 12:12:32 [INFO]: Epoch 028 - training loss: 31.1789, validation loss: 32.4712, 
2024-09-24 12:12:32 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch28_loss32.4712355687068.pypots
2024-09-24 12:13:35 [INFO]: Epoch 029 - training loss: 31.4700, validation loss: 32.5078, 
Model state change to unfreeze!
2024-09-24 12:15:13 [INFO]: Epoch 030 - training loss: 31.1211, validation loss: 32.3136, 
2024-09-24 12:15:13 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch30_loss32.313610810499924.pypots
2024-09-24 12:16:17 [INFO]: Epoch 031 - training loss: 31.0213, validation loss: 32.1803, 
2024-09-24 12:16:17 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch31_loss32.18027863135705.pypots
Model state change to unfreeze!
2024-09-24 12:17:55 [INFO]: Epoch 032 - training loss: 30.7340, validation loss: 32.1972, 
2024-09-24 12:18:58 [INFO]: Epoch 033 - training loss: 30.6765, validation loss: 32.0636, 
2024-09-24 12:18:59 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch33_loss32.06362005380484.pypots
Model state change to unfreeze!
2024-09-24 12:20:37 [INFO]: Epoch 034 - training loss: 30.4906, validation loss: 32.0284, 
2024-09-24 12:20:37 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch34_loss32.02838090749887.pypots
2024-09-24 12:21:40 [INFO]: Epoch 035 - training loss: 30.4724, validation loss: 31.9691, 
2024-09-24 12:21:40 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch35_loss31.969124427208534.pypots
Model state change to unfreeze!
2024-09-24 12:23:18 [INFO]: Epoch 036 - training loss: 30.3063, validation loss: 31.9166, 
2024-09-24 12:23:19 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch36_loss31.91655760544997.pypots
2024-09-24 12:24:22 [INFO]: Epoch 037 - training loss: 30.2473, validation loss: 31.8493, 
2024-09-24 12:24:22 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch37_loss31.849313735961914.pypots
Model state change to unfreeze!
2024-09-24 12:26:00 [INFO]: Epoch 038 - training loss: 30.1249, validation loss: 31.8156, 
2024-09-24 12:26:00 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch38_loss31.81561176593487.pypots
2024-09-24 12:27:04 [INFO]: Epoch 039 - training loss: 29.9950, validation loss: 31.6151, 
2024-09-24 12:27:04 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch39_loss31.615148250873272.pypots
Model state change to unfreeze!
2024-09-24 12:28:42 [INFO]: Epoch 040 - training loss: 29.9247, validation loss: 31.6346, 
2024-09-24 12:29:46 [INFO]: Epoch 041 - training loss: 29.9185, validation loss: 31.5252, 
2024-09-24 12:29:46 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch41_loss31.525165117703953.pypots
Model state change to unfreeze!
2024-09-24 12:31:24 [INFO]: Epoch 042 - training loss: 29.7546, validation loss: 31.4419, 
2024-09-24 12:31:24 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch42_loss31.441901720487156.pypots
2024-09-24 12:32:27 [INFO]: Epoch 043 - training loss: 29.6429, validation loss: 31.5033, 
Model state change to unfreeze!
2024-09-24 12:34:05 [INFO]: Epoch 044 - training loss: 29.6444, validation loss: 31.4927, 
2024-09-24 12:35:09 [INFO]: Epoch 045 - training loss: 29.6852, validation loss: 31.4061, 
2024-09-24 12:35:09 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch45_loss31.40608787536621.pypots
Model state change to unfreeze!
2024-09-24 12:36:47 [INFO]: Epoch 046 - training loss: 29.8138, validation loss: 31.4306, 
2024-09-24 12:37:51 [INFO]: Epoch 047 - training loss: 29.6227, validation loss: 31.3074, 
2024-09-24 12:37:51 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch47_loss31.307378915640022.pypots
Model state change to unfreeze!
2024-09-24 12:39:29 [INFO]: Epoch 048 - training loss: 29.5106, validation loss: 31.2526, 
2024-09-24 12:39:29 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch48_loss31.2525938474215.pypots
2024-09-24 12:40:32 [INFO]: Epoch 049 - training loss: 29.4095, validation loss: 31.1410, 
2024-09-24 12:40:32 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI_epoch49_loss31.14103581355168.pypots
Model state change to unfreeze!
2024-09-24 12:42:10 [INFO]: Epoch 050 - training loss: 29.3352, validation loss: 31.2769, 
2024-09-24 12:42:10 [INFO]: Finished training. The best model is from epoch#49.
2024-09-24 12:42:11 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240924_T113531/Bayesian_DEARI.pypots
INFO:__main__:
 Testing...................................... 

INFO:__main__:
 Fold 0 ended ........................................ 

INFO:__main__:
 Fold 0 Results: 
{
    "PyPots_evaluation": {
        "ROC_AUC": 0.7803425559947299,
        "PR_AUC": 0.34235379519153736,
        "F1": 0.22666666666666663,
        "Precision": 0.425,
        "Recall": 0.15454545454545454
    },
    "CSAI_evaluation": {
        "ACC": 0.855,
        "AUC": 0.7803425559947299,
        "Prec_Macro": 0.6513157894736842,
        "Recall_Macro": 0.5606060606060606,
        "F1_Macro": 0.5733333333333334,
        "Bal_ACC": 0.5606060606060606
    }
} 

