Lmod has detected the following error: The following module(s) are unknown:
"anaconda3/2021.05-gcc-9.4.0"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "anaconda3/2021.05-gcc-9.4.0"

Also make sure that all modulefiles written in TCL start with the string
#%Module



Lmod has detected the following error: The following module(s) are unknown:
"cuda/11.1.1-gcc-9.4.0"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "cuda/11.1.1-gcc-9.4.0"

Also make sure that all modulefiles written in TCL start with the string
#%Module



Lmod has detected the following error: The following module(s) are unknown:
"cudnn/8.0.5.39-11.1-gcc-9.4.0"

Please check the spelling or version number. Also try "module spider ..."
It is also possible your cache file is out-of-date; it may help to try:
  $ module --ignore_cache load "cudnn/8.0.5.39-11.1-gcc-9.4.0"

Also make sure that all modulefiles written in TCL start with the string
#%Module



Fri Sep 13 12:02:41 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.183.01             Driver Version: 535.183.01   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100-SXM4-40GB          On  | 00000000:17:00.0 Off |                    0 |
| N/A   33C    P0              53W / 400W |      0MiB / 40960MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
/var/lib/slurm/slurmd/job21076806/slurm_script: line 18: activate: No such file or directory
2024-09-13 12:04:04.605532: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-09-13 12:04:08.365187: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-09-13 12:04:30.558164: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
INFO:__main__:
 Fold 0 started ...................................... 

2024-09-13 12:05:06 [INFO]: Using the given device: cuda
2024-09-13 12:05:06 [INFO]: Model files will be saved to /scratch/users/k23031260/PyPOTS/20240913_T120506
2024-09-13 12:05:06 [INFO]: Tensorboard file will be saved to /scratch/users/k23031260/PyPOTS/20240913_T120506/tensorboard
INFO:__main__:
 Training..................................... 

/scratch/users/k23031260/.conda/envs/imputation/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2024-09-13 12:05:16 [INFO]: CSAI initialized with the given hyperparameters, the number of trainable parameters: 4,771,502
2024-09-13 12:05:32 [INFO]: Epoch 001 - training loss: 19.8551, validation loss: 17.4215, validation AUC: 0.4966053925763644
2024-09-13 12:05:32 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch1_loss17.421496171217697.pypots
2024-09-13 12:05:38 [INFO]: Epoch 002 - training loss: 15.9493, validation loss: 14.9795, validation AUC: 0.6574584374536451
2024-09-13 12:05:38 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch2_loss14.979489913353554.pypots
2024-09-13 12:05:44 [INFO]: Epoch 003 - training loss: 14.2548, validation loss: 13.8747, validation AUC: 0.7760471936010224
2024-09-13 12:05:44 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch3_loss13.874650735121508.pypots
2024-09-13 12:05:50 [INFO]: Epoch 004 - training loss: 13.3428, validation loss: 13.1115, validation AUC: 0.8137358938372186
2024-09-13 12:05:50 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch4_loss13.111526049100435.pypots
2024-09-13 12:05:56 [INFO]: Epoch 005 - training loss: 12.6785, validation loss: 12.5040, validation AUC: 0.8340807174887893
2024-09-13 12:05:56 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch5_loss12.50400081047645.pypots
2024-09-13 12:06:02 [INFO]: Epoch 006 - training loss: 12.1627, validation loss: 12.0352, validation AUC: 0.8508198404819771
2024-09-13 12:06:02 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch6_loss12.035209068885216.pypots
2024-09-13 12:06:09 [INFO]: Epoch 007 - training loss: 11.6513, validation loss: 11.5828, validation AUC: 0.8498499526466526
2024-09-13 12:06:09 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch7_loss11.582774309011606.pypots
2024-09-13 12:06:15 [INFO]: Epoch 008 - training loss: 11.3052, validation loss: 11.2321, validation AUC: 0.8583621447072651
2024-09-13 12:06:15 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch8_loss11.232126529400166.pypots
2024-09-13 12:06:21 [INFO]: Epoch 009 - training loss: 10.9663, validation loss: 10.9465, validation AUC: 0.8650828968838074
2024-09-13 12:06:21 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch9_loss10.946472608126127.pypots
2024-09-13 12:06:27 [INFO]: Epoch 010 - training loss: 10.7618, validation loss: 10.7389, validation AUC: 0.8638049270302034
2024-09-13 12:06:27 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch10_loss10.738909794734074.pypots
2024-09-13 12:06:33 [INFO]: Epoch 011 - training loss: 10.5480, validation loss: 10.6198, validation AUC: 0.8506258629149124
2024-09-13 12:06:33 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch11_loss10.619767115666317.pypots
2024-09-13 12:06:39 [INFO]: Epoch 012 - training loss: 10.3870, validation loss: 10.4472, validation AUC: 0.8605643606157076
2024-09-13 12:06:39 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch12_loss10.44724391056941.pypots
2024-09-13 12:06:45 [INFO]: Epoch 013 - training loss: 10.2086, validation loss: 10.3096, validation AUC: 0.8556350483232352
2024-09-13 12:06:45 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch13_loss10.309552999643179.pypots
2024-09-13 12:06:51 [INFO]: Epoch 014 - training loss: 10.0798, validation loss: 10.1739, validation AUC: 0.8625269571765994
2024-09-13 12:06:51 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch14_loss10.173876102154072.pypots
2024-09-13 12:06:57 [INFO]: Epoch 015 - training loss: 9.9415, validation loss: 10.0565, validation AUC: 0.8666461278654479
2024-09-13 12:06:57 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch15_loss10.05653770153339.pypots
2024-09-13 12:07:03 [INFO]: Epoch 016 - training loss: 9.8283, validation loss: 9.9481, validation AUC: 0.863325688335102
2024-09-13 12:07:03 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch16_loss9.94806275000939.pypots
2024-09-13 12:07:09 [INFO]: Epoch 017 - training loss: 9.6922, validation loss: 9.9070, validation AUC: 0.8664635607435046
2024-09-13 12:07:09 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch17_loss9.907046978290264.pypots
2024-09-13 12:07:15 [INFO]: Epoch 018 - training loss: 9.6060, validation loss: 9.8097, validation AUC: 0.8598911443535412
2024-09-13 12:07:15 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch18_loss9.809694950397198.pypots
2024-09-13 12:07:21 [INFO]: Epoch 019 - training loss: 9.5409, validation loss: 9.7606, validation AUC: 0.869989388286037
2024-09-13 12:07:21 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch19_loss9.760592313913198.pypots
2024-09-13 12:07:27 [INFO]: Epoch 020 - training loss: 9.4575, validation loss: 9.7574, validation AUC: 0.8667716427617842
2024-09-13 12:07:27 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch20_loss9.757406088022085.pypots
2024-09-13 12:07:34 [INFO]: Epoch 021 - training loss: 9.3948, validation loss: 9.6642, validation AUC: 0.8601535845913348
2024-09-13 12:07:34 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch21_loss9.664151485149677.pypots
2024-09-13 12:07:40 [INFO]: Epoch 022 - training loss: 9.3306, validation loss: 9.6316, validation AUC: 0.8560458243476078
2024-09-13 12:07:40 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch22_loss9.631555557250977.pypots
2024-09-13 12:07:46 [INFO]: Epoch 023 - training loss: 9.3060, validation loss: 9.6051, validation AUC: 0.854722212713518
2024-09-13 12:07:46 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch23_loss9.605094029353214.pypots
2024-09-13 12:07:52 [INFO]: Epoch 024 - training loss: 9.2244, validation loss: 9.6119, validation AUC: 0.854699391823275
2024-09-13 12:07:57 [INFO]: Epoch 025 - training loss: 9.1648, validation loss: 9.5212, validation AUC: 0.8517554969819372
2024-09-13 12:07:58 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch25_loss9.521164967463566.pypots
2024-09-13 12:08:03 [INFO]: Epoch 026 - training loss: 9.1255, validation loss: 9.4918, validation AUC: 0.8550873469574047
2024-09-13 12:08:04 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch26_loss9.491754311781664.pypots
2024-09-13 12:08:10 [INFO]: Epoch 027 - training loss: 9.1028, validation loss: 9.4686, validation AUC: 0.8524743550245896
2024-09-13 12:08:10 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch27_loss9.468608709482046.pypots
2024-09-13 12:08:16 [INFO]: Epoch 028 - training loss: 9.0499, validation loss: 9.4682, validation AUC: 0.8566277570488026
2024-09-13 12:08:16 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch28_loss9.468163930452787.pypots
2024-09-13 12:08:22 [INFO]: Epoch 029 - training loss: 9.0216, validation loss: 9.5157, validation AUC: 0.8501238033295678
2024-09-13 12:08:28 [INFO]: Epoch 030 - training loss: 8.9307, validation loss: 9.4084, validation AUC: 0.8450119239151519
2024-09-13 12:08:28 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI_epoch30_loss9.408410145686222.pypots
2024-09-13 12:08:34 [INFO]: Epoch 031 - training loss: 8.8653, validation loss: 9.4911, validation AUC: 0.8337612250253883
2024-09-13 12:08:40 [INFO]: Epoch 032 - training loss: 8.8738, validation loss: 9.4475, validation AUC: 0.8396604251531853
2024-09-13 12:08:46 [INFO]: Epoch 033 - training loss: 8.8115, validation loss: 9.4653, validation AUC: 0.8333048072205297
2024-09-13 12:08:52 [INFO]: Epoch 034 - training loss: 8.7482, validation loss: 9.4411, validation AUC: 0.8224877052453815
2024-09-13 12:08:58 [INFO]: Epoch 035 - training loss: 8.7117, validation loss: 9.4449, validation AUC: 0.8189504672577277
2024-09-13 12:08:58 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-09-13 12:08:58 [INFO]: Finished training. The best model is from epoch#30.
2024-09-13 12:08:58 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120506/CSAI.pypots
INFO:__main__:
 Testing...................................... 

INFO:__main__:
 Fold 0 ended ........................................ 

INFO:__main__:
 Fold 0 Results: 
{
    "PyPots_evaluation": {
        "ROC_AUC": 0.7999868247694335,
        "PR_AUC": 0.40923534439915027,
        "F1": 0.326797385620915,
        "Precision": 0.5813953488372093,
        "Recall": 0.22727272727272727
    },
    "CSAI_evaluation": {
        "ACC": 0.87125,
        "AUC": 0.7999868247694335,
        "Prec_Macro": 0.7345550059905994,
        "Recall_Macro": 0.600592885375494,
        "F1_Macro": 0.627807815132503,
        "Bal_ACC": 0.600592885375494
    }
} 

INFO:__main__:
 Fold 1 started ...................................... 

2024-09-13 12:09:02 [INFO]: Using the given device: cuda
2024-09-13 12:09:02 [INFO]: Model files will be saved to /scratch/users/k23031260/PyPOTS/20240913_T120902
2024-09-13 12:09:02 [INFO]: Tensorboard file will be saved to /scratch/users/k23031260/PyPOTS/20240913_T120902/tensorboard
INFO:__main__:
 Training..................................... 

/scratch/users/k23031260/.conda/envs/imputation/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2024-09-13 12:09:11 [INFO]: CSAI initialized with the given hyperparameters, the number of trainable parameters: 4,771,502
2024-09-13 12:09:17 [INFO]: Epoch 001 - training loss: 19.8380, validation loss: 17.5980, validation AUC: 0.5338787497377806
2024-09-13 12:09:17 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch1_loss17.59797653785119.pypots
2024-09-13 12:09:23 [INFO]: Epoch 002 - training loss: 15.9641, validation loss: 15.1263, validation AUC: 0.6651488789348339
2024-09-13 12:09:23 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch2_loss15.12628489274245.pypots
2024-09-13 12:09:29 [INFO]: Epoch 003 - training loss: 14.3313, validation loss: 14.0248, validation AUC: 0.7368674341983489
2024-09-13 12:09:29 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch3_loss14.024825316209059.pypots
2024-09-13 12:09:35 [INFO]: Epoch 004 - training loss: 13.4015, validation loss: 13.3206, validation AUC: 0.7668036377546614
2024-09-13 12:09:35 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch4_loss13.320613787724422.pypots
2024-09-13 12:09:41 [INFO]: Epoch 005 - training loss: 12.7353, validation loss: 12.7163, validation AUC: 0.7872012241019756
2024-09-13 12:09:41 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch5_loss12.716337717496431.pypots
2024-09-13 12:09:47 [INFO]: Epoch 006 - training loss: 12.1400, validation loss: 12.1862, validation AUC: 0.8018608324387023
2024-09-13 12:09:48 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch6_loss12.186163535484901.pypots
2024-09-13 12:09:54 [INFO]: Epoch 007 - training loss: 11.6714, validation loss: 11.7651, validation AUC: 0.8000839102160688
2024-09-13 12:09:54 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch7_loss11.765064973097582.pypots
2024-09-13 12:10:00 [INFO]: Epoch 008 - training loss: 11.2592, validation loss: 11.4473, validation AUC: 0.7982823085181209
2024-09-13 12:10:00 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch8_loss11.447268706101637.pypots
2024-09-13 12:10:06 [INFO]: Epoch 009 - training loss: 10.9614, validation loss: 11.1697, validation AUC: 0.8008366342131565
2024-09-13 12:10:06 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch9_loss11.169659467843863.pypots
2024-09-13 12:10:12 [INFO]: Epoch 010 - training loss: 10.7048, validation loss: 10.9466, validation AUC: 0.8111032959439283
2024-09-13 12:10:12 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch10_loss10.946574284480167.pypots
2024-09-13 12:10:18 [INFO]: Epoch 011 - training loss: 10.4913, validation loss: 10.7678, validation AUC: 0.8016510568985304
2024-09-13 12:10:18 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch11_loss10.767754774827223.pypots
2024-09-13 12:10:24 [INFO]: Epoch 012 - training loss: 10.2789, validation loss: 10.5824, validation AUC: 0.8090795789681512
2024-09-13 12:10:24 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch12_loss10.582400542039137.pypots
2024-09-13 12:10:30 [INFO]: Epoch 013 - training loss: 10.1285, validation loss: 10.4989, validation AUC: 0.8066116314367157
2024-09-13 12:10:30 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch13_loss10.498880899869478.pypots
2024-09-13 12:10:36 [INFO]: Epoch 014 - training loss: 10.0109, validation loss: 10.3582, validation AUC: 0.806290798257629
2024-09-13 12:10:36 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch14_loss10.358169629023624.pypots
2024-09-13 12:10:42 [INFO]: Epoch 015 - training loss: 9.8685, validation loss: 10.2522, validation AUC: 0.8099557003418107
2024-09-13 12:10:42 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch15_loss10.252222941471981.pypots
2024-09-13 12:10:48 [INFO]: Epoch 016 - training loss: 9.7759, validation loss: 10.2081, validation AUC: 0.8008119547378423
2024-09-13 12:10:48 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch16_loss10.208140519949106.pypots
2024-09-13 12:10:54 [INFO]: Epoch 017 - training loss: 9.6913, validation loss: 10.1220, validation AUC: 0.7995656412344674
2024-09-13 12:10:54 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch17_loss10.121957192054161.pypots
2024-09-13 12:11:00 [INFO]: Epoch 018 - training loss: 9.6082, validation loss: 10.0452, validation AUC: 0.7976900011105763
2024-09-13 12:11:00 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch18_loss10.04515633216271.pypots
2024-09-13 12:11:07 [INFO]: Epoch 019 - training loss: 9.5294, validation loss: 9.9853, validation AUC: 0.8068707659275163
2024-09-13 12:11:07 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch19_loss9.985262870788574.pypots
2024-09-13 12:11:13 [INFO]: Epoch 020 - training loss: 9.4589, validation loss: 10.0217, validation AUC: 0.8058218882266563
2024-09-13 12:11:19 [INFO]: Epoch 021 - training loss: 9.3960, validation loss: 9.9241, validation AUC: 0.8132750897715915
2024-09-13 12:11:19 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch21_loss9.924118335430439.pypots
2024-09-13 12:11:25 [INFO]: Epoch 022 - training loss: 9.3173, validation loss: 9.8431, validation AUC: 0.8125100260368465
2024-09-13 12:11:25 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch22_loss9.843071497403658.pypots
2024-09-13 12:11:31 [INFO]: Epoch 023 - training loss: 9.2848, validation loss: 9.8281, validation AUC: 0.8046989720998532
2024-09-13 12:11:31 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch23_loss9.828058609595665.pypots
2024-09-13 12:11:37 [INFO]: Epoch 024 - training loss: 9.2376, validation loss: 9.8259, validation AUC: 0.8040943249546514
2024-09-13 12:11:37 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch24_loss9.825871027432955.pypots
2024-09-13 12:11:43 [INFO]: Epoch 025 - training loss: 9.1740, validation loss: 9.7791, validation AUC: 0.8060193240291711
2024-09-13 12:11:43 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch25_loss9.779062491196852.pypots
2024-09-13 12:11:49 [INFO]: Epoch 026 - training loss: 9.1133, validation loss: 9.7563, validation AUC: 0.8030207677784771
2024-09-13 12:11:49 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch26_loss9.756314864525429.pypots
2024-09-13 12:11:55 [INFO]: Epoch 027 - training loss: 9.0885, validation loss: 9.8235, validation AUC: 0.804402818396081
2024-09-13 12:12:01 [INFO]: Epoch 028 - training loss: 9.0216, validation loss: 9.7160, validation AUC: 0.8045015362973382
2024-09-13 12:12:01 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch28_loss9.71602880037748.pypots
2024-09-13 12:12:07 [INFO]: Epoch 029 - training loss: 8.9750, validation loss: 9.7326, validation AUC: 0.8029467293525341
2024-09-13 12:12:13 [INFO]: Epoch 030 - training loss: 8.9495, validation loss: 9.7374, validation AUC: 0.8016140376855588
2024-09-13 12:12:19 [INFO]: Epoch 031 - training loss: 8.9167, validation loss: 9.6785, validation AUC: 0.8000839102160688
2024-09-13 12:12:19 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch31_loss9.678529225862944.pypots
2024-09-13 12:12:25 [INFO]: Epoch 032 - training loss: 8.8744, validation loss: 9.6473, validation AUC: 0.8043904786584237
2024-09-13 12:12:25 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch32_loss9.647251716026894.pypots
2024-09-13 12:12:31 [INFO]: Epoch 033 - training loss: 8.8384, validation loss: 9.6853, validation AUC: 0.7965917644590875
2024-09-13 12:12:37 [INFO]: Epoch 034 - training loss: 8.8245, validation loss: 9.6900, validation AUC: 0.8031194856797345
2024-09-13 12:12:43 [INFO]: Epoch 035 - training loss: 8.7635, validation loss: 9.7357, validation AUC: 0.7963079504929726
2024-09-13 12:12:49 [INFO]: Epoch 036 - training loss: 8.7447, validation loss: 9.7541, validation AUC: 0.7911129209393007
2024-09-13 12:12:55 [INFO]: Epoch 037 - training loss: 8.6846, validation loss: 9.6365, validation AUC: 0.7853996224040277
2024-09-13 12:12:55 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI_epoch37_loss9.636484439556416.pypots
2024-09-13 12:13:01 [INFO]: Epoch 038 - training loss: 8.6647, validation loss: 9.7143, validation AUC: 0.7943089129925098
2024-09-13 12:13:07 [INFO]: Epoch 039 - training loss: 8.7310, validation loss: 9.6946, validation AUC: 0.7955922457088561
2024-09-13 12:13:14 [INFO]: Epoch 040 - training loss: 8.6248, validation loss: 9.6612, validation AUC: 0.7932600352916497
2024-09-13 12:13:20 [INFO]: Epoch 041 - training loss: 8.6021, validation loss: 9.7136, validation AUC: 0.7877318328212342
2024-09-13 12:13:26 [INFO]: Epoch 042 - training loss: 8.5472, validation loss: 9.6806, validation AUC: 0.7863497822036304
2024-09-13 12:13:26 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-09-13 12:13:26 [INFO]: Finished training. The best model is from epoch#37.
2024-09-13 12:13:26 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T120902/CSAI.pypots
INFO:__main__:
 Testing...................................... 

INFO:__main__:
 Fold 1 ended ........................................ 

INFO:__main__:
 Fold 1 Results: 
{
    "PyPots_evaluation": {
        "ROC_AUC": 0.7708333333333334,
        "PR_AUC": 0.4004018527922971,
        "F1": 0.39263803680981596,
        "Precision": 0.5423728813559322,
        "Recall": 0.3076923076923077
    },
    "CSAI_evaluation": {
        "ACC": 0.87625,
        "AUC": 0.7708333333333334,
        "Prec_Macro": 0.722603444726549,
        "Recall_Macro": 0.6344496021220158,
        "F1_Macro": 0.6618722543130499,
        "Bal_ACC": 0.6344496021220158
    }
} 

INFO:__main__:
 Fold 2 started ...................................... 

2024-09-13 12:13:29 [INFO]: Using the given device: cuda
2024-09-13 12:13:29 [INFO]: Model files will be saved to /scratch/users/k23031260/PyPOTS/20240913_T121329
2024-09-13 12:13:29 [INFO]: Tensorboard file will be saved to /scratch/users/k23031260/PyPOTS/20240913_T121329/tensorboard
INFO:__main__:
 Training..................................... 

/scratch/users/k23031260/.conda/envs/imputation/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2024-09-13 12:13:39 [INFO]: CSAI initialized with the given hyperparameters, the number of trainable parameters: 4,771,502
2024-09-13 12:13:45 [INFO]: Epoch 001 - training loss: 19.8475, validation loss: 17.6167, validation AUC: 0.5809640640785105
2024-09-13 12:13:45 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch1_loss17.61674191401555.pypots
2024-09-13 12:13:51 [INFO]: Epoch 002 - training loss: 15.9218, validation loss: 15.1607, validation AUC: 0.6880502236975032
2024-09-13 12:13:51 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch2_loss15.160728748028095.pypots
2024-09-13 12:13:57 [INFO]: Epoch 003 - training loss: 14.2607, validation loss: 13.9902, validation AUC: 0.7676793188050224
2024-09-13 12:13:57 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch3_loss13.990155880267803.pypots
2024-09-13 12:14:03 [INFO]: Epoch 004 - training loss: 13.3474, validation loss: 13.2878, validation AUC: 0.7781666426131718
2024-09-13 12:14:03 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch4_loss13.287820229163536.pypots
2024-09-13 12:14:09 [INFO]: Epoch 005 - training loss: 12.6907, validation loss: 12.7066, validation AUC: 0.7864650983787944
2024-09-13 12:14:09 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch5_loss12.70658830495981.pypots
2024-09-13 12:14:15 [INFO]: Epoch 006 - training loss: 12.1345, validation loss: 12.2049, validation AUC: 0.7893394910280463
2024-09-13 12:14:15 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch6_loss12.204926637502817.pypots
2024-09-13 12:14:21 [INFO]: Epoch 007 - training loss: 11.6593, validation loss: 11.7718, validation AUC: 0.7989248087747151
2024-09-13 12:14:21 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch7_loss11.771849412184496.pypots
2024-09-13 12:14:28 [INFO]: Epoch 008 - training loss: 11.2531, validation loss: 11.4333, validation AUC: 0.7916125463029777
2024-09-13 12:14:28 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch8_loss11.43331028864934.pypots
2024-09-13 12:14:33 [INFO]: Epoch 009 - training loss: 10.9356, validation loss: 11.1864, validation AUC: 0.7990210227546063
2024-09-13 12:14:33 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch9_loss11.186383614173302.pypots
2024-09-13 12:14:39 [INFO]: Epoch 010 - training loss: 10.6980, validation loss: 11.0176, validation AUC: 0.8005243661904073
2024-09-13 12:14:39 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch10_loss11.017565727233887.pypots
2024-09-13 12:14:45 [INFO]: Epoch 011 - training loss: 10.5164, validation loss: 10.8152, validation AUC: 0.8005724731803532
2024-09-13 12:14:46 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch11_loss10.81515957758977.pypots
2024-09-13 12:14:52 [INFO]: Epoch 012 - training loss: 10.3187, validation loss: 10.6378, validation AUC: 0.8013421850194833
2024-09-13 12:14:52 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch12_loss10.63784591968243.pypots
2024-09-13 12:14:58 [INFO]: Epoch 013 - training loss: 10.1152, validation loss: 10.5081, validation AUC: 0.8024486457882332
2024-09-13 12:14:58 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch13_loss10.508104764498198.pypots
2024-09-13 12:15:04 [INFO]: Epoch 014 - training loss: 9.9899, validation loss: 10.3729, validation AUC: 0.796459325540001
2024-09-13 12:15:04 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch14_loss10.372918495765099.pypots
2024-09-13 12:15:10 [INFO]: Epoch 015 - training loss: 9.8594, validation loss: 10.3116, validation AUC: 0.8013782652619426
2024-09-13 12:15:10 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch15_loss10.311591001657339.pypots
2024-09-13 12:15:16 [INFO]: Epoch 016 - training loss: 9.7446, validation loss: 10.2354, validation AUC: 0.8044811661134363
2024-09-13 12:15:16 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch16_loss10.235374890840971.pypots
2024-09-13 12:15:22 [INFO]: Epoch 017 - training loss: 9.6591, validation loss: 10.1343, validation AUC: 0.8100134699571848
2024-09-13 12:15:22 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch17_loss10.134286440335787.pypots
2024-09-13 12:15:28 [INFO]: Epoch 018 - training loss: 9.5688, validation loss: 10.0724, validation AUC: 0.8039880694664934
2024-09-13 12:15:28 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch18_loss10.072449977581318.pypots
2024-09-13 12:15:34 [INFO]: Epoch 019 - training loss: 9.5057, validation loss: 10.0097, validation AUC: 0.8036272670419011
2024-09-13 12:15:35 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch19_loss10.009667323185848.pypots
2024-09-13 12:15:40 [INFO]: Epoch 020 - training loss: 9.4289, validation loss: 9.9999, validation AUC: 0.8061769375090201
2024-09-13 12:15:41 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch20_loss9.999937864450308.pypots
2024-09-13 12:15:46 [INFO]: Epoch 021 - training loss: 9.3561, validation loss: 9.9410, validation AUC: 0.8058762688218599
2024-09-13 12:15:46 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch21_loss9.940957436194786.pypots
2024-09-13 12:15:52 [INFO]: Epoch 022 - training loss: 9.2925, validation loss: 9.9246, validation AUC: 0.8167604752970608
2024-09-13 12:15:52 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch22_loss9.924552550682655.pypots
2024-09-13 12:15:58 [INFO]: Epoch 023 - training loss: 9.2463, validation loss: 9.8549, validation AUC: 0.8096165872901333
2024-09-13 12:15:58 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch23_loss9.854878132159893.pypots
2024-09-13 12:16:05 [INFO]: Epoch 024 - training loss: 9.1737, validation loss: 9.8140, validation AUC: 0.808558233511329
2024-09-13 12:16:05 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch24_loss9.814040257380558.pypots
2024-09-13 12:16:11 [INFO]: Epoch 025 - training loss: 9.1330, validation loss: 9.7736, validation AUC: 0.8207653822100353
2024-09-13 12:16:11 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch25_loss9.773633883549618.pypots
2024-09-13 12:16:17 [INFO]: Epoch 026 - training loss: 9.0987, validation loss: 9.7521, validation AUC: 0.8032784913647953
2024-09-13 12:16:17 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch26_loss9.752125373253456.pypots
2024-09-13 12:16:23 [INFO]: Epoch 027 - training loss: 9.0337, validation loss: 9.7578, validation AUC: 0.8066580074084766
2024-09-13 12:16:29 [INFO]: Epoch 028 - training loss: 8.9899, validation loss: 9.7796, validation AUC: 0.7995622263914947
2024-09-13 12:16:35 [INFO]: Epoch 029 - training loss: 8.9836, validation loss: 9.7480, validation AUC: 0.795665560205898
2024-09-13 12:16:35 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch29_loss9.748024500333345.pypots
2024-09-13 12:16:41 [INFO]: Epoch 030 - training loss: 8.9059, validation loss: 9.7315, validation AUC: 0.7934165584259394
2024-09-13 12:16:41 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch30_loss9.731545301584097.pypots
2024-09-13 12:16:47 [INFO]: Epoch 031 - training loss: 8.8881, validation loss: 9.7377, validation AUC: 0.8008370616250542
2024-09-13 12:16:53 [INFO]: Epoch 032 - training loss: 8.8780, validation loss: 9.7357, validation AUC: 0.8071511040554193
2024-09-13 12:16:59 [INFO]: Epoch 033 - training loss: 8.8250, validation loss: 9.7180, validation AUC: 0.7788281137249242
2024-09-13 12:16:59 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch33_loss9.717986547029936.pypots
2024-09-13 12:17:05 [INFO]: Epoch 034 - training loss: 8.7778, validation loss: 9.6552, validation AUC: 0.8032063308798769
2024-09-13 12:17:05 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI_epoch34_loss9.655178436866173.pypots
2024-09-13 12:17:11 [INFO]: Epoch 035 - training loss: 8.7297, validation loss: 9.7163, validation AUC: 0.8014744792418339
2024-09-13 12:17:17 [INFO]: Epoch 036 - training loss: 8.7866, validation loss: 9.6828, validation AUC: 0.7946432866695531
2024-09-13 12:17:23 [INFO]: Epoch 037 - training loss: 8.6777, validation loss: 9.6914, validation AUC: 0.7854668783374225
2024-09-13 12:17:29 [INFO]: Epoch 038 - training loss: 8.7008, validation loss: 9.7403, validation AUC: 0.796988502429403
2024-09-13 12:17:35 [INFO]: Epoch 039 - training loss: 8.6678, validation loss: 9.6835, validation AUC: 0.7959421753980854
2024-09-13 12:17:35 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-09-13 12:17:35 [INFO]: Finished training. The best model is from epoch#34.
2024-09-13 12:17:35 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121329/CSAI.pypots
INFO:__main__:
 Testing...................................... 

INFO:__main__:
 Fold 2 ended ........................................ 

INFO:__main__:
 Fold 2 Results: 
{
    "PyPots_evaluation": {
        "ROC_AUC": 0.8132865385489072,
        "PR_AUC": 0.4924055309152301,
        "F1": 0.32954545454545453,
        "Precision": 0.6590909090909091,
        "Recall": 0.2196969696969697
    },
    "CSAI_evaluation": {
        "ACC": 0.8523153942428036,
        "AUC": 0.8132865385489072,
        "Prec_Macro": 0.7613335340156532,
        "Recall_Macro": 0.5986041070373904,
        "F1_Macro": 0.623281869326173,
        "Bal_ACC": 0.5986041070373904
    }
} 

INFO:__main__:
 Fold 3 started ...................................... 

2024-09-13 12:17:39 [INFO]: Using the given device: cuda
2024-09-13 12:17:39 [INFO]: Model files will be saved to /scratch/users/k23031260/PyPOTS/20240913_T121739
2024-09-13 12:17:39 [INFO]: Tensorboard file will be saved to /scratch/users/k23031260/PyPOTS/20240913_T121739/tensorboard
INFO:__main__:
 Training..................................... 

/scratch/users/k23031260/.conda/envs/imputation/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2024-09-13 12:17:48 [INFO]: CSAI initialized with the given hyperparameters, the number of trainable parameters: 4,771,502
2024-09-13 12:17:54 [INFO]: Epoch 001 - training loss: 19.8825, validation loss: 17.4137, validation AUC: 0.5158057340583293
2024-09-13 12:17:54 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch1_loss17.413655647864708.pypots
2024-09-13 12:18:01 [INFO]: Epoch 002 - training loss: 16.0221, validation loss: 14.9347, validation AUC: 0.6432773109243698
2024-09-13 12:18:01 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch2_loss14.93472458766057.pypots
2024-09-13 12:18:07 [INFO]: Epoch 003 - training loss: 14.3395, validation loss: 13.8289, validation AUC: 0.7859861591695502
2024-09-13 12:18:07 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch3_loss13.82885162646954.pypots
2024-09-13 12:18:13 [INFO]: Epoch 004 - training loss: 13.4141, validation loss: 13.1185, validation AUC: 0.8242956005931786
2024-09-13 12:18:13 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch4_loss13.118463369516226.pypots
2024-09-13 12:18:19 [INFO]: Epoch 005 - training loss: 12.7445, validation loss: 12.5076, validation AUC: 0.831957488877904
2024-09-13 12:18:19 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch5_loss12.50760790017935.pypots
2024-09-13 12:18:24 [INFO]: Epoch 006 - training loss: 12.1803, validation loss: 12.0181, validation AUC: 0.8430548690064261
2024-09-13 12:18:25 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch6_loss12.018106460571289.pypots
2024-09-13 12:18:31 [INFO]: Epoch 007 - training loss: 11.7076, validation loss: 11.6133, validation AUC: 0.8420044488383589
2024-09-13 12:18:31 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch7_loss11.613336343031664.pypots
2024-09-13 12:18:37 [INFO]: Epoch 008 - training loss: 11.3546, validation loss: 11.3158, validation AUC: 0.8478868017795355
2024-09-13 12:18:37 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch8_loss11.315820840688852.pypots
2024-09-13 12:18:43 [INFO]: Epoch 009 - training loss: 11.0431, validation loss: 11.1116, validation AUC: 0.845304003954523
2024-09-13 12:18:43 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch9_loss11.111641370333158.pypots
2024-09-13 12:18:49 [INFO]: Epoch 010 - training loss: 10.8137, validation loss: 10.9210, validation AUC: 0.8418685121107267
2024-09-13 12:18:49 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch10_loss10.920994465167706.pypots
2024-09-13 12:18:55 [INFO]: Epoch 011 - training loss: 10.6497, validation loss: 10.7272, validation AUC: 0.8377656945130993
2024-09-13 12:18:55 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch11_loss10.727198380690355.pypots
2024-09-13 12:19:01 [INFO]: Epoch 012 - training loss: 10.4457, validation loss: 10.5835, validation AUC: 0.846280276816609
2024-09-13 12:19:01 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch12_loss10.583506510807918.pypots
2024-09-13 12:19:07 [INFO]: Epoch 013 - training loss: 10.2859, validation loss: 10.4547, validation AUC: 0.8366658428077114
2024-09-13 12:19:07 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch13_loss10.454722331120418.pypots
2024-09-13 12:19:13 [INFO]: Epoch 014 - training loss: 10.1591, validation loss: 10.3023, validation AUC: 0.8379263470093921
2024-09-13 12:19:14 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch14_loss10.302282993610088.pypots
2024-09-13 12:19:20 [INFO]: Epoch 015 - training loss: 10.0102, validation loss: 10.2317, validation AUC: 0.8472936233316857
2024-09-13 12:19:20 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch15_loss10.23169524853046.pypots
2024-09-13 12:19:26 [INFO]: Epoch 016 - training loss: 9.8710, validation loss: 10.1016, validation AUC: 0.8339841819080575
2024-09-13 12:19:26 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch16_loss10.101593971252441.pypots
2024-09-13 12:19:32 [INFO]: Epoch 017 - training loss: 9.7457, validation loss: 10.0257, validation AUC: 0.834268413247652
2024-09-13 12:19:32 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch17_loss10.025650537931002.pypots
2024-09-13 12:19:38 [INFO]: Epoch 018 - training loss: 9.6776, validation loss: 9.9535, validation AUC: 0.8422639644092931
2024-09-13 12:19:38 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch18_loss9.953543516305777.pypots
2024-09-13 12:19:44 [INFO]: Epoch 019 - training loss: 9.5949, validation loss: 9.9773, validation AUC: 0.8271131982204647
2024-09-13 12:19:50 [INFO]: Epoch 020 - training loss: 9.5266, validation loss: 9.9032, validation AUC: 0.8192535837864557
2024-09-13 12:19:50 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch20_loss9.903202497042143.pypots
2024-09-13 12:19:56 [INFO]: Epoch 021 - training loss: 9.4495, validation loss: 9.8674, validation AUC: 0.8209218981710331
2024-09-13 12:19:56 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch21_loss9.867419976454515.pypots
2024-09-13 12:20:02 [INFO]: Epoch 022 - training loss: 9.3996, validation loss: 9.8199, validation AUC: 0.8238012852199703
2024-09-13 12:20:02 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch22_loss9.81988026545598.pypots
2024-09-13 12:20:08 [INFO]: Epoch 023 - training loss: 9.3449, validation loss: 9.8067, validation AUC: 0.8128769154720712
2024-09-13 12:20:08 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch23_loss9.806729390070988.pypots
2024-09-13 12:20:14 [INFO]: Epoch 024 - training loss: 9.2911, validation loss: 9.7355, validation AUC: 0.8299678695007415
2024-09-13 12:20:14 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch24_loss9.735456540034367.pypots
2024-09-13 12:20:21 [INFO]: Epoch 025 - training loss: 9.2479, validation loss: 9.7462, validation AUC: 0.8284602076124568
2024-09-13 12:20:27 [INFO]: Epoch 026 - training loss: 9.1890, validation loss: 9.7657, validation AUC: 0.8208601087493821
2024-09-13 12:20:33 [INFO]: Epoch 027 - training loss: 9.1731, validation loss: 9.6901, validation AUC: 0.82194760257044
2024-09-13 12:20:33 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch27_loss9.690123631403996.pypots
2024-09-13 12:20:39 [INFO]: Epoch 028 - training loss: 9.1152, validation loss: 9.6960, validation AUC: 0.8299555116164113
2024-09-13 12:20:45 [INFO]: Epoch 029 - training loss: 9.0335, validation loss: 9.6730, validation AUC: 0.8254695996045477
2024-09-13 12:20:45 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch29_loss9.672953972449669.pypots
2024-09-13 12:20:51 [INFO]: Epoch 030 - training loss: 9.0020, validation loss: 9.6380, validation AUC: 0.827805239742956
2024-09-13 12:20:51 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch30_loss9.637961314274715.pypots
2024-09-13 12:20:57 [INFO]: Epoch 031 - training loss: 8.9571, validation loss: 9.6237, validation AUC: 0.8336875926841324
2024-09-13 12:20:57 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch31_loss9.62369889479417.pypots
2024-09-13 12:21:03 [INFO]: Epoch 032 - training loss: 8.9231, validation loss: 9.6379, validation AUC: 0.8148912506178941
2024-09-13 12:21:09 [INFO]: Epoch 033 - training loss: 8.8739, validation loss: 9.6433, validation AUC: 0.8089594661393971
2024-09-13 12:21:15 [INFO]: Epoch 034 - training loss: 8.8328, validation loss: 9.6885, validation AUC: 0.804695996045477
2024-09-13 12:21:21 [INFO]: Epoch 035 - training loss: 8.8352, validation loss: 9.5828, validation AUC: 0.8196613939693524
2024-09-13 12:21:21 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI_epoch35_loss9.58282654102032.pypots
2024-09-13 12:21:27 [INFO]: Epoch 036 - training loss: 8.7549, validation loss: 9.6210, validation AUC: 0.7901631240731587
2024-09-13 12:21:33 [INFO]: Epoch 037 - training loss: 8.7074, validation loss: 9.5951, validation AUC: 0.7956376668314384
2024-09-13 12:21:39 [INFO]: Epoch 038 - training loss: 8.6545, validation loss: 9.6687, validation AUC: 0.7702916460701927
2024-09-13 12:21:45 [INFO]: Epoch 039 - training loss: 8.6706, validation loss: 9.6737, validation AUC: 0.7659540286702917
2024-09-13 12:21:51 [INFO]: Epoch 040 - training loss: 8.6064, validation loss: 9.5919, validation AUC: 0.7831562036579338
2024-09-13 12:21:51 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-09-13 12:21:51 [INFO]: Finished training. The best model is from epoch#35.
2024-09-13 12:21:51 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T121739/CSAI.pypots
INFO:__main__:
 Testing...................................... 

INFO:__main__:
 Fold 3 ended ........................................ 

INFO:__main__:
 Fold 3 Results: 
{
    "PyPots_evaluation": {
        "ROC_AUC": 0.8221998842486825,
        "PR_AUC": 0.42611023661860026,
        "F1": 0.39999999999999997,
        "Precision": 0.4583333333333333,
        "Recall": 0.3548387096774194
    },
    "CSAI_evaluation": {
        "ACC": 0.8760951188986232,
        "AUC": 0.8221998842486825,
        "Prec_Macro": 0.6879011921137093,
        "Recall_Macro": 0.6497989582381432,
        "F1_Macro": 0.665457083042568,
        "Bal_ACC": 0.6497989582381432
    }
} 

INFO:__main__:
 Fold 4 started ...................................... 

2024-09-13 12:21:55 [INFO]: Using the given device: cuda
2024-09-13 12:21:55 [INFO]: Model files will be saved to /scratch/users/k23031260/PyPOTS/20240913_T122155
2024-09-13 12:21:55 [INFO]: Tensorboard file will be saved to /scratch/users/k23031260/PyPOTS/20240913_T122155/tensorboard
INFO:__main__:
 Training..................................... 

/scratch/users/k23031260/.conda/envs/imputation/lib/python3.8/site-packages/torch/nn/modules/transformer.py:282: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
2024-09-13 12:22:04 [INFO]: CSAI initialized with the given hyperparameters, the number of trainable parameters: 4,771,502
2024-09-13 12:22:10 [INFO]: Epoch 001 - training loss: 19.7550, validation loss: 17.4351, validation AUC: 0.5277519903226714
2024-09-13 12:22:10 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch1_loss17.435132100031925.pypots
2024-09-13 12:22:16 [INFO]: Epoch 002 - training loss: 15.7833, validation loss: 15.0071, validation AUC: 0.642318620418038
2024-09-13 12:22:16 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch2_loss15.007051687974196.pypots
2024-09-13 12:22:22 [INFO]: Epoch 003 - training loss: 14.2049, validation loss: 13.9272, validation AUC: 0.7292879849213717
2024-09-13 12:22:22 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch3_loss13.927179703345665.pypots
2024-09-13 12:22:28 [INFO]: Epoch 004 - training loss: 13.3239, validation loss: 13.2162, validation AUC: 0.7507103271724759
2024-09-13 12:22:28 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch4_loss13.21615402515118.pypots
2024-09-13 12:22:34 [INFO]: Epoch 005 - training loss: 12.6727, validation loss: 12.6155, validation AUC: 0.7631445691619545
2024-09-13 12:22:34 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch5_loss12.615543512197641.pypots
2024-09-13 12:22:40 [INFO]: Epoch 006 - training loss: 12.0835, validation loss: 12.0658, validation AUC: 0.7773370467268688
2024-09-13 12:22:41 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch6_loss12.065805288461538.pypots
2024-09-13 12:22:47 [INFO]: Epoch 007 - training loss: 11.6361, validation loss: 11.6526, validation AUC: 0.7797704447632713
2024-09-13 12:22:47 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch7_loss11.652607697706957.pypots
2024-09-13 12:22:53 [INFO]: Epoch 008 - training loss: 11.2179, validation loss: 11.2851, validation AUC: 0.7865923987959602
2024-09-13 12:22:53 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch8_loss11.285062423119179.pypots
2024-09-13 12:22:59 [INFO]: Epoch 009 - training loss: 10.9033, validation loss: 11.0406, validation AUC: 0.7826539511069851
2024-09-13 12:22:59 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch9_loss11.040606351999136.pypots
2024-09-13 12:23:05 [INFO]: Epoch 010 - training loss: 10.6604, validation loss: 10.8240, validation AUC: 0.7906574394463667
2024-09-13 12:23:06 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch10_loss10.823973142183744.pypots
2024-09-13 12:23:12 [INFO]: Epoch 011 - training loss: 10.4568, validation loss: 10.6639, validation AUC: 0.785649984527527
2024-09-13 12:23:12 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch11_loss10.663858340336727.pypots
2024-09-13 12:23:18 [INFO]: Epoch 012 - training loss: 10.2834, validation loss: 10.4640, validation AUC: 0.7900666722930204
2024-09-13 12:23:18 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch12_loss10.463965269235464.pypots
2024-09-13 12:23:24 [INFO]: Epoch 013 - training loss: 10.1037, validation loss: 10.3295, validation AUC: 0.7903198582158832
2024-09-13 12:23:24 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch13_loss10.329508854792667.pypots
2024-09-13 12:23:31 [INFO]: Epoch 014 - training loss: 9.9464, validation loss: 10.2101, validation AUC: 0.7876754719104284
2024-09-13 12:23:31 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch14_loss10.210116239694448.pypots
2024-09-13 12:23:37 [INFO]: Epoch 015 - training loss: 9.8494, validation loss: 10.1288, validation AUC: 0.792556333867837
2024-09-13 12:23:37 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch15_loss10.128803693331205.pypots
2024-09-13 12:23:43 [INFO]: Epoch 016 - training loss: 9.7545, validation loss: 10.0486, validation AUC: 0.7848060314513179
2024-09-13 12:23:43 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch16_loss10.048647660475512.pypots
2024-09-13 12:23:49 [INFO]: Epoch 017 - training loss: 9.6540, validation loss: 10.0037, validation AUC: 0.7942301741356514
2024-09-13 12:23:49 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch17_loss10.003671866196852.pypots
2024-09-13 12:23:55 [INFO]: Epoch 018 - training loss: 9.5533, validation loss: 9.9426, validation AUC: 0.781486482684896
2024-09-13 12:23:55 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch18_loss9.942629153911884.pypots
2024-09-13 12:24:01 [INFO]: Epoch 019 - training loss: 9.4786, validation loss: 9.8861, validation AUC: 0.7929923762905449
2024-09-13 12:24:01 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch19_loss9.886068124037523.pypots
2024-09-13 12:24:08 [INFO]: Epoch 020 - training loss: 9.4157, validation loss: 9.7993, validation AUC: 0.7877317354488423
2024-09-13 12:24:08 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch20_loss9.799341935377855.pypots
2024-09-13 12:24:14 [INFO]: Epoch 021 - training loss: 9.3380, validation loss: 9.8065, validation AUC: 0.786789321180409
2024-09-13 12:24:20 [INFO]: Epoch 022 - training loss: 9.2901, validation loss: 9.7783, validation AUC: 0.7809097814161531
2024-09-13 12:24:20 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch22_loss9.778309235206017.pypots
2024-09-13 12:24:26 [INFO]: Epoch 023 - training loss: 9.2254, validation loss: 9.7417, validation AUC: 0.7812051649928263
2024-09-13 12:24:26 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch23_loss9.74165703700139.pypots
2024-09-13 12:24:32 [INFO]: Epoch 024 - training loss: 9.1778, validation loss: 9.7390, validation AUC: 0.7845669114130588
2024-09-13 12:24:32 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch24_loss9.739037880530724.pypots
2024-09-13 12:24:38 [INFO]: Epoch 025 - training loss: 9.1469, validation loss: 9.7079, validation AUC: 0.7792781388021494
2024-09-13 12:24:38 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch25_loss9.707893738379845.pypots
2024-09-13 12:24:44 [INFO]: Epoch 026 - training loss: 9.1043, validation loss: 9.6506, validation AUC: 0.78469350437449
2024-09-13 12:24:45 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch26_loss9.650553336510292.pypots
2024-09-13 12:24:50 [INFO]: Epoch 027 - training loss: 9.0213, validation loss: 9.6380, validation AUC: 0.7773511126114723
2024-09-13 12:24:51 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch27_loss9.63803085914025.pypots
2024-09-13 12:24:57 [INFO]: Epoch 028 - training loss: 8.9983, validation loss: 9.6047, validation AUC: 0.7793625341097702
2024-09-13 12:24:57 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch28_loss9.604698988107534.pypots
2024-09-13 12:25:03 [INFO]: Epoch 029 - training loss: 8.9608, validation loss: 9.6082, validation AUC: 0.785213942104819
2024-09-13 12:25:09 [INFO]: Epoch 030 - training loss: 8.8889, validation loss: 9.5917, validation AUC: 0.7713590457703885
2024-09-13 12:25:09 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch30_loss9.591749264643742.pypots
2024-09-13 12:25:15 [INFO]: Epoch 031 - training loss: 8.8505, validation loss: 9.5793, validation AUC: 0.7748614510366558
2024-09-13 12:25:15 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch31_loss9.579335065988394.pypots
2024-09-13 12:25:21 [INFO]: Epoch 032 - training loss: 8.8151, validation loss: 9.5944, validation AUC: 0.7682645511576223
2024-09-13 12:25:27 [INFO]: Epoch 033 - training loss: 8.7853, validation loss: 9.5422, validation AUC: 0.772624975384702
2024-09-13 12:25:27 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch33_loss9.54223764859713.pypots
2024-09-13 12:25:33 [INFO]: Epoch 034 - training loss: 8.7152, validation loss: 9.5936, validation AUC: 0.7766618842659014
2024-09-13 12:25:40 [INFO]: Epoch 035 - training loss: 8.6958, validation loss: 9.6095, validation AUC: 0.7647340141221483
2024-09-13 12:25:46 [INFO]: Epoch 036 - training loss: 8.7181, validation loss: 9.5777, validation AUC: 0.7849185585281458
2024-09-13 12:25:52 [INFO]: Epoch 037 - training loss: 8.6481, validation loss: 9.4928, validation AUC: 0.7674065321968098
2024-09-13 12:25:52 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch37_loss9.492766306950497.pypots
2024-09-13 12:25:58 [INFO]: Epoch 038 - training loss: 8.5793, validation loss: 9.4996, validation AUC: 0.7613019382788984
2024-09-13 12:26:04 [INFO]: Epoch 039 - training loss: 8.5310, validation loss: 9.5502, validation AUC: 0.7683067488114328
2024-09-13 12:26:10 [INFO]: Epoch 040 - training loss: 8.5103, validation loss: 9.6960, validation AUC: 0.7804596731088417
2024-09-13 12:26:16 [INFO]: Epoch 041 - training loss: 8.6236, validation loss: 9.4729, validation AUC: 0.7637494021999043
2024-09-13 12:26:16 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch41_loss9.472880730262169.pypots
2024-09-13 12:26:22 [INFO]: Epoch 042 - training loss: 8.4435, validation loss: 9.4721, validation AUC: 0.7571665682054746
2024-09-13 12:26:22 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch42_loss9.472069373497597.pypots
2024-09-13 12:26:28 [INFO]: Epoch 043 - training loss: 8.4412, validation loss: 9.5390, validation AUC: 0.7747911216136383
2024-09-13 12:26:34 [INFO]: Epoch 044 - training loss: 8.3844, validation loss: 9.4883, validation AUC: 0.7643261034686472
2024-09-13 12:26:40 [INFO]: Epoch 045 - training loss: 8.3603, validation loss: 9.4581, validation AUC: 0.7577995330126311
2024-09-13 12:26:40 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch45_loss9.458125554598295.pypots
2024-09-13 12:26:46 [INFO]: Epoch 046 - training loss: 8.3310, validation loss: 9.4998, validation AUC: 0.7775902326497314
2024-09-13 12:26:53 [INFO]: Epoch 047 - training loss: 8.2575, validation loss: 9.5115, validation AUC: 0.7640166540073705
2024-09-13 12:26:59 [INFO]: Epoch 048 - training loss: 8.2970, validation loss: 9.4353, validation AUC: 0.7679691675809491
2024-09-13 12:26:59 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI_epoch48_loss9.435322248018705.pypots
2024-09-13 12:27:05 [INFO]: Epoch 049 - training loss: 8.2504, validation loss: 9.4680, validation AUC: 0.7643542352378541
2024-09-13 12:27:11 [INFO]: Epoch 050 - training loss: 8.2382, validation loss: 9.4753, validation AUC: 0.7467015500604832
2024-09-13 12:27:17 [INFO]: Epoch 051 - training loss: 8.2924, validation loss: 9.4827, validation AUC: 0.7728640954229612
2024-09-13 12:27:23 [INFO]: Epoch 052 - training loss: 8.1721, validation loss: 9.4675, validation AUC: 0.7588685402424958
2024-09-13 12:27:29 [INFO]: Epoch 053 - training loss: 8.1054, validation loss: 9.5912, validation AUC: 0.7507947224800968
2024-09-13 12:27:29 [INFO]: Exceeded the training patience. Terminating the training procedure...
2024-09-13 12:27:29 [INFO]: Finished training. The best model is from epoch#48.
2024-09-13 12:27:29 [INFO]: Saved the model to /scratch/users/k23031260/PyPOTS/20240913_T122155/CSAI.pypots
INFO:__main__:
 Testing...................................... 

INFO:__main__:
 Fold 4 ended ........................................ 

INFO:__main__:
 Fold 4 Results: 
{
    "PyPots_evaluation": {
        "ROC_AUC": 0.839816933638444,
        "PR_AUC": 0.4424882640898875,
        "F1": 0.3870967741935485,
        "Precision": 0.5070422535211268,
        "Recall": 0.3130434782608696
    },
    "CSAI_evaluation": {
        "ACC": 0.8573216520650814,
        "AUC": 0.839816933638444,
        "Prec_Macro": 0.6992628850023217,
        "Recall_Macro": 0.6309369438087974,
        "F1_Macro": 0.6531801151421001,
        "Bal_ACC": 0.6309369438087974
    }
} 

INFO:__main__:
 Average performance across all folds.......................... 

INFO:__main__:
 Classification performance using Pypots evaluation: 
 {'ROC_AUC': 0.8092247029077602, 'PR_AUC': 0.434128245763033, 'F1': 0.36721553023394676, 'Precision': 0.5496469452277022, 'Recall': 0.28450883852005876} 

INFO:__main__:
 Classification performance using CSAI evaluation: 
 {'ACC': 0.8666464330413017, 'AUC': 0.8092247029077602, 'Prec_Macro': 0.7211312123697666, 'Recall_Macro': 0.6228764993163682, 'F1_Macro': 0.6463198273912789, 'Bal_ACC': 0.6228764993163682} 

